{% extends "analyzer/report.html" %}
{% load static %}
{% load conversion %}
{% block metas %}
    <meta name="description" content="Analyse {{ report.id }} - Extracted files">
    <meta name="keywords" content="analysis, overview, extracted files">
    <title> Analysis  {{ report.pk }} - Extracted Files</title>
{% endblock %}
{% block content %}
    <div class="col-xl-9">
        <div class="card report-block">
            <div class="card-body">
                <div class="accordion accordion-flush" id="accordionFiles">
                    <h2 class="wrapper card-title">
                        <span class="text">Files Extracted </span>
                    </h2>
                    {% for file in files %}
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="fileHeading{{ forloop.counter }}">
                                <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                        aria-expanded="false"
                                        data-bs-target="#fileCollapse{{ forloop.counter }}"
                                        aria-controls="fileCollapse{{ forloop.counter }}">
                                    <div class="col-xl-8">
                                        {% if file.submit_name %}
                                            {{ file.submit_name }}
                                        {% else %}
                                            {{ file.name }}
                                        {% endif %}
                                    </div>
                                    {% if file.media_type %}
                                    <div class="col-xl-4">
                                        <i class="bi bi-file-earmark"></i>
                                        <span class="text">{{ file.media_type }}</span>
                                    </div>
                                    {% endif %}
                                </button>
                            </h2>
                            <div id="fileCollapse{{ forloop.counter }}"
                                 aria-labelledby="fileHeading{{ forloop.counter }}"
                                 data-bs-parent="#accordionFiles" class="accordion-collapse collapse show">
                                <div class="accordion-body">
                                    <h3 class="wrapper title fw-italic text-muted">
                                        <span class="text"> Overview</span>
                                    </h3>
                                    {% if file.origin %}
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold">Origin: &nbsp;</span>
                                        <span class="text"> {{ file.origin }}</span>
                                    </div>
                                    {% endif %}
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold">Description: &nbsp;</span>
                                        <span class="text"> {{ file.description }}</span>
                                    </div>
                                    {% if file.size %}
                                         <div class="d-flex align-items">
                                        <span class="text fw-bold">Size: &nbsp;</span>
                                        <span class="text">{{ file.size|convert|floatformat:2}} {{ file.size|storage_unit }}</span>
                                    </div>
                                    {% if file.file_path %}
                                        <div class="d-flex align-items">
                                            <span class="text fw-bold">File Path: &nbsp;</span>
                                            <span class="text">{{ file.file_path }}</span>
                                        </div>
                                    {% endif %}
                                    {% endif %}
                                    <h3 class="wrapper title fw-italic text-muted">Hashes</h3>
                                    {% if file.MD5 %}
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold">MD5: &nbsp </span>
                                        <span class="text"> {{ file.MD5 }} </span>
                                    </div>
                                    {% endif %}
                                    {% if file.SHA1 %}
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold">SHA1: &nbsp; </span>
                                        <span class="text"> {{ file.SHA1 }} </span>
                                    </div>
                                    {% endif %}
                                    {% if file.SHA256 %}
                                    <div class="d-flex  align-items">
                                        <span class="text fw-bold">SHA256: &nbsp;</span>
                                        <span class="text"> {{ file.SHA256 }}</span>
                                    </div>
                                    {% endif %}
                                    {% if file.SHA512 %}
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold"> SHA512: &nbsp; </span>
                                        {% include 'analyzer/fragments/full_value_modal.html' with value=file.SHA512 postfix=file.SHA512 %}
                                    </div>
                                    {% endif %}
                                    {% if file.ssdeep %}
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold">ssdeep: &nbsp;</span>
                                        {% include 'analyzer/fragments/full_value_modal.html' with value=file.ssdeep postifx=file.ssdeep %}
                                    </div>
                                    {% endif %}
                                    {% if file.entropy %}
                                    <h3 class="wrapper title fw-italic text-muted">Meta</h3>
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold">Entropy: &nbsp;</span>
                                        <span class="text">{{ file.entropy|floatformat:1 }}</span>
                                    </div>
                                    {% endif %}
                                    {% if file.resource_id %}
                                    <div class="d-flex align-items">
                                        <span class="text fw-bold">Resource ID: &nbsp;</span>
                                        <span class="text">{{ file.resource_id }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

{% endblock %}