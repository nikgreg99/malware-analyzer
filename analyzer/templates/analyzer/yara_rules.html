{% extends "analyzer/report.html" %}
{% block metas %}
    <title>Analyse {{ overview.pk }} - Yara</title>
{% endblock %}
{% block content %}
    <div class="col-xl-9">
        <div class="card report-block">
            <div class="card-body">
                <h2 class="wrapper card-title">
                    <span class="text">Yara Rules </span>
                </h2>
                <span class="text-muted fst-italic">Yara Rules helps to identify and classify your malware by creating different
                classification groups based on textual or binary patterns.</span>
                {% for yara_rule in yara_rules %}
                    <div class="accordion report-block">
                        <div class="card">
                            <div class="card-header">
                                <div class="title">{{ yara_rule.rule_name }}</div>
                            </div>
                           <div class="collapse show">
                                 <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                            <div class="d-flex align-items">
                                            <span class="label fw-bold">Description: &nbsp;</span>
                                            <span class="text">
                                                {% if yara_rule.description %}
                                                    {{ yara_rule.description }}
                                                {% else %}
                                                    -
                                                {% endif  %}
                                            </span>
                                        </div>
                                        <div class="d-flex align-items">
                                            <div class="label fw-bold">Matches: &nbsp;</div>
                                                <ul class="list-group list-group-flush">
                                                     {% for match  in yara_rule.match_strings.all %}
                                                         <li class="list-group-item"> {{ match.match_string }}</li>
                                                     {% endfor %}
                                                </ul>
                                        </div>
                                    </div>
                                    <div class="col-md-3 offset-md-3">
                                        {%if yara_rule.author %}
                                        <div class="d-flex align-items">
                                              <span class="label fw-bold">Author: &nbsp;</span>
                                                <span class="text">{{ yara_rule.author }}</span>
                                        </div>
                                        {% endif %}
                                        {% if yara_rule.date %}
                                            <div class="d-flex align-items">
                                              <span class="label fw-bold">Date: &nbsp;</span>
                                                <span class="text">{{ yara_rule.date }}</span>
                                            </div>
                                        {% endif %}
                                        {% if yara_rule.file_type %}
                                             <div class="d-flex align-items">
                                              <span class="label fw-bold">File Type: &nbsp;</span>
                                                <span class="text">{{ yara_rule.file_type }}</span>
                                            </div>
                                        {% endif %}
                                        {% if yara_rule.reference %}
                                            <span class="label fw-bold">Reference: &nbsp;</span>
                                            <a class="link-dark fw-" href="{{ yara_rule.reference }}">{{ yara_rule.reference }}</a>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                           </div>
                        </div>
                    </div>
                {% endfor %}

            </div>
        </div>
    </div>
{% endblock %}