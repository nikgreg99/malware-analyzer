from django.db import models
from django.utils.translation import gettext_lazy as _

from .target import Target


class Sandbox(models.TextChoices):
    CUCKOO = "Cuckoo", _("Cuckoo")
    HYBRID_ANALYSIS = "Hybrid_Analysis", _("Hybrid_Analysis"),
    FILE_SCAN_IO = "FileScanIO", _("FileScanIO"),
    VIRUS_TOTAL = "Virus_Total", _("Virus_Total")


class Overview(models.Model):
    target = models.ForeignKey(Target, on_delete=models.CASCADE, null=True)
    sandbox = models.CharField(max_length=30, choices=Sandbox.choices, default=Sandbox.CUCKOO)
    size = models.IntegerField(default=0,blank=True)
    job_id = models.CharField(max_length=80, default="", blank=True)
    type = models.CharField(max_length=100, default="", blank=True)
    MD5 = models.CharField(max_length=33, default="", blank=True)
    SHA1 = models.CharField(max_length=42, default="", blank=True)
    SHA256 = models.CharField(max_length=65, default="", blank=True)
    SHA512 = models.CharField(max_length=129, default="", blank=True)
    CRC32 = models.CharField(max_length=10, default="", blank=True)
    analyse_start_time = models.DateTimeField("analyse_start_time")
    ssdeep = models.CharField(max_length=148, default="", blank=True)

    @property
    def has_MD5(self):
        return self.MD5 != "" or self.MD5 is not None

    @property
    def has_SHA1(self):
        return self.SHA1 != "" or self.SHA1 is not None

    @property
    def has_SHA256(self):
        return self.SHA256 != "" or self.SHA256 is not None

    @property
    def has_SHA512(self):
        return self.SHA512 != "" or self.SHA256 is not None

    @property
    def has_ssdeep(self):
        return self.ssdeep != "" or self.SHA256 is not None

    @property
    def has_CRC32(self):
        return self.CRC32 != "" or self.CRC32 is not None
