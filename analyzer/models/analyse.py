from django.contrib.postgres.fields import ArrayField
from django.db import models

from .analyse_type import AnalyseType
from .malware import Malware
from .sandbox import Sandbox


class Analyse(models.Model):
    malware = models.ForeignKey(Malware, on_delete=models.CASCADE, null=True)
    md5 = models.CharField(max_length=128, default="None")
    sha1 = models.CharField(max_length=160, default="None")
    sha256 = models.CharField(max_length=256, default="None")
    crc32 = models.IntegerField(default=0)
    ssdeep = models.CharField(max_length=148, default="None")
    strings = ArrayField(models.TextField(max_length=400, default="None"))
    datetime = models.DateTimeField("analyse time")
    type = models.ForeignKey(AnalyseType, on_delete=models.CASCADE)
    sandbox = models.ForeignKey(Sandbox, on_delete=models.CASCADE)

