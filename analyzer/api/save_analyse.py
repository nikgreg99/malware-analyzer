from analyzer.models import Target, Analyse, Sandbox, TargetType


def save_hybrid_analysis_overview(target_id: Target, overview: dict):
    target = Target.objects.get(id=target_id)
    if target.type == TargetType.URL:
        size = 0
        type = ""
    else:
        size = overview['size']
        type = overview['type']
    MD5 = overview['md5']
    SHA1 = overview['sha1']
    SHA256 = overview['sha256']
    SHA512 = overview['sha512']
    analyse_start_time = overview['analysis_start_time']
    analyse = Analyse.objects.create(sandbox=Sandbox.HYBRID_ANALYSIS,
                                     size=size,
                                     type=type,
                                     MD5=MD5,
                                     SHA1=SHA1,
                                     SHA256=SHA256,
                                     SHA512=SHA512,
                                     analyse_start_time=analyse_start_time,
                                     target=target)
    return analyse


def save_file_scan_io_overview(target_id: Target, overview: dict):
    target = Target.objects.get(id=target_id)
