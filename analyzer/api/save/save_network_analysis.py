from django.core.files.base import ContentFile

from analyzer.models import Overview
from analyzer.models.network_analysis import NetworkAnalysis


def save_network_analysis(overview: Overview, response, file_name_prefix):
    full_file_name = "%s.pcap" % file_name_prefix
    pcap_file_content = ContentFile(response.content, name=full_file_name)
    network_analysis, created = NetworkAnalysis.objects.get_or_create(pcap_file=pcap_file_content)
    Overview.objects.filter(pk=overview.id).update(network_analysis=network_analysis)


