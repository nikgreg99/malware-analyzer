from analyzer.models import VersionInfo, Overview


def save_version_infos(overview: Overview, dict_version_infos: dict):
    for dict_version_info in dict_version_infos:
        ver_info = save_version_info_if_not_exits(dict_version_info)
        overview.version_info.add(ver_info)


def save_version_info_if_not_exits(dict_version_info: dict):
    name = dict_version_info['name']
    value = dict_version_info['value']
    ver_info = VersionInfo.objects.filter(name=name, value=value)
    if not ver_info.exists():
        ver_info = VersionInfo(name=name, value=value)
        ver_info.save()
    else:
        ver_info = ver_info.get()
    return ver_info
