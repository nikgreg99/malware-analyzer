from analyzer.models import String, Summary


def save_string_if_not_exists(string: dict):
    str_name = string['str']
    string_row, created = String.objects.get_or_create(name=str_name)
    return string_row


def save_strings(overview: Summary, strings: dict):
    for string in strings:
        string_row = save_string_if_not_exists(string)
        overview.strings.add(string_row)


def save_cuckoo_strings(overview: Summary, strings: list):
    for string in strings:
        overview.strings.get_or_create(name=string)
