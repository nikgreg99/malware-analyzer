from analyzer.models import String, Overview


def save_string_if_not_exists(dict_string: dict):
    str_name = dict_string['str']
    type = dict_string['type']
    offset = dict_string['metaData']['offset']
    string, created = String.objects.get_or_create(name=str_name, type=type, offset=offset)
    return string


def save_strings(overview: Overview, dict_strings):
    for dict_string in dict_strings:
        string = save_string_if_not_exists(dict_string)
        overview.strings.add(string)
