from analyzer.models import Target, Analyse, Sandbox


def save_hybrid_analysis_overview(target_id: Target, overview: dict):

    size = overview['size']
    type = overview['type']
    MD5 = overview['md5']
    SHA1 = overview['sha1']
    SHA256 = overview['sha256']
    SHA512 = overview['sha512']
    analyse_start_time = overview['analysis_start_time']
    analyse = Analyse(sandbox=Sandbox.HYBRID_ANALYSIS,
                      size=size,
                      type=type,
                      MD5=MD5,
                      SHA1=SHA1,
                      SHA256=SHA256,
                      SHA512=SHA512,
                      analyse_start_time=analyse_start_time,
                      target=Target.objects.get(id=target_id))
    analyse.save()
