from analyzer.models import Target, Analyse, Sandbox


def save_hybrid_analysis_analyse(target_id: Target, json_analyse):
    size = json_analyse['size']
    type = json_analyse['type']
    MD5 = json_analyse['md5']
    SHA1 = json_analyse['sha1']
    SHA256 = json_analyse['sha256']
    SHA512 = json_analyse['sha512']
    analyse_start_time = json_analyse['analysis_start_time']
    analyse = Analyse(sandbox=Sandbox.HYBRID_ANALYSIS,
                      size=size,
                      type=type,
                      MD5=MD5,
                      SHA1=SHA1,
                      SHA256=SHA256,
                      SHA512=SHA512,
                      analyse_start_time=analyse_start_time,
                      target=Target.objects.get(id=target_id))
    analyse.save()
