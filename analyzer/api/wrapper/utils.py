import json
import requests
from requests.exceptions import HTTPError


def build_cuckoo_api_path(host: str, port: int, protocol: str):
    return "{0}://{1}:{2}".format(protocol, host, port)


def connect(session: requests.Session, method: str, url: str, **kwargs):
    try:
        response = session.request(method, url, **kwargs)
        response.raise_for_status()
        if response.headers["Content-Type"] == "application/json":
            return json.loads(response.text)
        return response
    except HTTPError as http_error:
        print(f'HTTP error occurred: {http_error}')
    except Exception as err:
        print(f'Other error occurred: {err}')
