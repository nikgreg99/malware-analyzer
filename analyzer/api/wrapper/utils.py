import hashlib
import json
import requests
from requests.exceptions import HTTPError


def compute_file_sha256(file):
    sha256_hash = hashlib.sha256()
    for byte_block in iter(lambda: file.read(4096), b""):
        sha256_hash.update(byte_block)
    return sha256_hash.hexdigest()


def build_cuckoo_api_path(host: str, port: int, protocol: str):
    return "{0}://{1}:{2}".format(protocol, host, port)


def connect(session: requests.Session, method: str, url: str, **kwargs):
    try:
        response = session.request(method, url, **kwargs)
        response.raise_for_status()
        if response.headers["Content-Type"] == "application/json":
            return json.loads(response.text)
        return response
    except HTTPError as http_error:
        print(f'HTTP error occurred: {http_error}')
    except Exception as err:
        print(f'Other error occurred: {err}')
