import vt
from vt import Object


class VirusTotalAPI(object):

    def __init__(self, api_key):
        self.client = vt.Client(api_key)

    @staticmethod
    def create(self, api_key):
        if self.instance is None:
            self.instance = VirusTotalAPI(api_key)
        return api_key

    def submit_file(self, file_name: str):
        file = None
        # analysis = self.client.scan_file(file)

    def submit_url(self, url: str):
        analysis = self.client.scan_url(url)
        return analysis

    def get_attribute(self, analyse: Object, param):
        return self.client.get(analyse, param)

    def get_analyse(self, analyse_id):
        while True:
            analysis = self.client.get_object("/analyses/{}", analyse_id)
            if analysis.status == "completed":
                break
        return analysis
