from django.shortcuts import render, get_object_or_404

from analyzer.models.report import Report
from analyzer.views.utils import get_sandbox_report


def get_extracted_files(request, report_id, sandbox):
    report = get_object_or_404(Report, pk=report_id)
    overview = get_sandbox_report(report, sandbox)
    context = {
        'report': report,
        'overview': overview,
        'files': overview.extracted_files.all(),
        'sandbox': sandbox
    }
    return render(request, "analyzer/files.html", context=context)
