from django.shortcuts import render, get_object_or_404
from scapy.all import *
from scapy.layers.inet import IP


def get_network_analysis(request, overview_id):
    overview = get_object_or_404(pk=overview_id)
    file = ''
    packets = []
    for p in rdpcap(file):
        if IP in packet:
            src = p[IP].src
            dst = p[IP].dst
            packets.append({src, dst})

    context = {
        'overview': overview,
        'packets': packets
    }

    return render(request, 'analyzer/network.html', context=context)
