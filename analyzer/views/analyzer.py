from django.shortcuts import render, redirect
from analyzer.models import Sandbox
from analyzer.models import Malware


def index(request):
    return render(request, 'analyzer/index.html')


def submit_malware(request):
    if request.method == 'POST':

        malware = Malware(request.FILES.get('file'))
        if not Malware.objects.contains(malware):
            malware.save()

            response = redirect("/analyzer/")
            return response
    else:
        sandboxes = Sandbox.objects.all()
        context = {
            'sandboxes': sandboxes
        }
        return render(request, 'analyzer/submit_file.html', context)
