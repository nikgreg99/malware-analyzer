import mimetypes

from django.http import HttpResponse
from django.shortcuts import render, get_object_or_404
from analyzer.models import Analyse


def get_analyse_overview(request, analyse_id):
    analyse = get_object_or_404(Analyse, pk=analyse_id)
    return render(request, "analyzer/overview.html", context = {'analyse' : analyse})


def download_sample(request, analyse_id):
    analyse = Analyse.objects.filter(pk=analyse_id).get()
    file = analyse.target.name
    mime_type = mimetypes.guess_type(file.url)
    response = HttpResponse(file, content_type=mime_type)
    response["Content-Disposition"] = "attachment; filename=%s " % file.name
    return response
