from django.shortcuts import redirect, render
from django.views.generic.base import View

from analyzer.models import Sandbox, Target


class SubmitFile(View):

    def get(self, request, *args, **kwargs):

        context = dict()
        context["sandboxes"] = Sandbox.choices()
        return render(request, "analyzer/submit_file.html", context)

    def post(self, request, *args, **kwargs):
        request = Target(request.FILES["file"])
        if not Target.objects.contains(request):
            request.save()

        response = redirect("/analyzer/")
        return response


class SubmitUrl(View):

    def get(self, request, *args, **kwargs):
        return render(request, "analyzer/submit_url.html")
