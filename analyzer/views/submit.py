from django.shortcuts import redirect, render
from django.views.generic.base import View, TemplateView

from analyzer.models import Sandbox, Malware


class SubmitFile(View):

    def get(self, request, *args, **kwargs):
        context = dict()
        context["sandboxes"] = Sandbox.objects.all()
        return render(request, "analyzer/submit_file.html", context)

    def post(self, request, *args, **kwargs):
        malware = Malware(request.FILES.get('file'))
        if not Malware.objects.contains(malware):
            malware.save()

        response = redirect("/analyzer/")
        return response


class SubmitUrl(View):

    def get(self, request, *args, **kwargs):
        return render(request, "analyzer/submit_url.html")
