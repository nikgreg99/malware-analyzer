from django.conf.urls import handler404
from django.urls import path

from .views import SubmitFile, SubmitURL
from .views.index import HomeView, error404
from .views.details import get_analyse_details
from .views.files import get_extracted_files
from .views.overview import download_sample, download_report, get_analyse_overview
from .views.strings import get_strings
from .views.yara_rules import get_yara_rules
from .views.analysis import AnalysisView
from .views.process import get_process_list
from .views.option import get_options, delete_analyse
from .views.network import get_network_analysis
app_name = "analyzer"

handler404 = error404

urlpatterns = [
    path("", HomeView.as_view(), name="index"),
    path("analysis", view=AnalysisView.as_view(), kwargs={'q': ''}, name="analysisList"),
    path("analysis/<int:overview_id>/overview", view=get_analyse_overview, name="overviewAnalyse"),
    path("analysis/<int:overview_id>/overview/download/sample", view=download_sample, name="downloadFile"),
    path("analysis/<int:overview_id>/overview/download/report/<str:report_format>", view=download_report, name="downloadReport"),
    path("analysis/<int:overview_id>/details", view=get_analyse_details,name="detailsAnalyse"),
    path("analysis/<int:overview_id>/strings", view=get_strings,name="stringAnalyse"),
    path("analysis/<int:overview_id>/files", view=get_extracted_files,name="extractedFiles"),
    path("analysis/<int:overview_id>/yara", view=get_yara_rules, name="yaraRules"),
    path("analysis/<int:overview_id>/process", view=get_process_list,name="processList"),
    path("analysis/<int:overview_id>/option", view=get_options, name="optionAnalyse"),
    path("analysis/<int:overview_id>/network", view=get_network_analysis ,name="networkAnalyse"),
    path("analysis/<int:overview_id>/delete", view=delete_analyse, name="deleteAnalyse"),
    path("target/<int:target_id>/delete", view=delete_analyse, name="deleteTarget"),
    path("submit/file", SubmitFile.as_view(), name="submitFile"),
    path("submit/url", SubmitURL.as_view(), name="submitURL"),
]
