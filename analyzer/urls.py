from django.urls import path

from .views import SubmitFile, SubmitURL
from .views import HomeView
from .views.details import get_analyse_details
from .views.files import get_extracted_files
from .views.overview import download_sample, download_report, delete_analyse, get_analyse_overview
from .views.strings import get_strings
from .views.yara_rules import get_yara_rules
from .views.list import ListView
from .views.search import search_by_target

app_name = "analyzer"
urlpatterns = [
    path("", HomeView.as_view(), name="index"),
    path("list", view=ListView.as_view(), kwargs={'q': ''}, name="analysisList"),
    path("target/<int:target_id>/delete", view=delete_analyse, name="deleteTarget"),
    path("submit/file", SubmitFile.as_view(), name="submitFile"),
    path("submit/url", SubmitURL.as_view(), name="submitURL"),
    path("report/<int:overview_id>/overview", view=get_analyse_overview, name="overviewAnalyse"),
    path("report/<int:overview_id>/overview/download/sample", view=download_sample, name="downloadFile"),
    path("report/<int:overview_id>/overview/download/report/<str:report_format>", view=download_report, name="downloadReport"),
    path("report/<int:overview_id>/details", view=get_analyse_details,name="detailsAnalyse"),
    path("report/<int:overview_id>/strings", view=get_strings,name="stringAnalyse"),
    path("report/<int:overview_id>/files", view=get_extracted_files,name="extractedFiles"),
    path("report/<int:overview_id>/yara", view=get_yara_rules, name="yaraRules"),
    path("report/<int:overview_id>/delete", view=delete_analyse, name="deleteAnalyse"),
]
